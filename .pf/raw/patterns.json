{
  "findings": [
    {
      "category": "business_logic",
      "column": 20,
      "file": "backend/src/middleware/auditLogger.ts",
      "line": 8,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "const startTime = Date.now();"
    },
    {
      "category": "business_logic",
      "column": 21,
      "file": "backend/src/middleware/auditLogger.ts",
      "line": 25,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "const duration = Date.now() - startTime;"
    },
    {
      "category": "flow_sensitive",
      "column": 21,
      "file": "backend/src/database/seed.ts",
      "line": 507,
      "match_type": "regex",
      "message": "Database/network connection without explicit close",
      "pattern_name": "connection-no-close",
      "severity": "high",
      "snippet": "await prisma.$disconnect();"
    },
    {
      "category": "frameworks/svelte",
      "column": 22,
      "file": "backend/src/database/seed.ts",
      "line": 8,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "async function main() {"
    },
    {
      "category": "frameworks/svelte",
      "column": 32,
      "file": "backend/src/database/seed.ts",
      "line": 88,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.profile.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 32,
      "file": "backend/src/database/seed.ts",
      "line": 102,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.profile.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 47,
      "file": "backend/src/database/seed.ts",
      "line": 117,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const vendor1 = await prisma.vendor.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 47,
      "file": "backend/src/database/seed.ts",
      "line": 139,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const vendor2 = await prisma.vendor.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 43,
      "file": "backend/src/database/seed.ts",
      "line": 419,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const post1 = await prisma.post.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 43,
      "file": "backend/src/database/seed.ts",
      "line": 435,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const post2 = await prisma.post.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 32,
      "file": "backend/src/database/seed.ts",
      "line": 453,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.comment.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 32,
      "file": "backend/src/database/seed.ts",
      "line": 462,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.comment.create({"
    },
    {
      "category": "security",
      "column": 14,
      "file": "backend/src/config/environment.ts",
      "line": 63,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "// Email (Resend - free tier)"
    },
    {
      "category": "flow_sensitive",
      "column": 18,
      "file": "backend/src/config/database.ts",
      "line": 31,
      "match_type": "regex",
      "message": "Database/network connection without explicit close",
      "pattern_name": "connection-no-close",
      "severity": "high",
      "snippet": "await prisma.$connect();"
    },
    {
      "category": "flow_sensitive",
      "column": 21,
      "file": "backend/src/config/database.ts",
      "line": 45,
      "match_type": "regex",
      "message": "Database/network connection without explicit close",
      "pattern_name": "connection-no-close",
      "severity": "high",
      "snippet": "await prisma.$disconnect();"
    },
    {
      "category": "flow_sensitive",
      "column": 19,
      "file": "backend/src/config/database.ts",
      "line": 56,
      "match_type": "regex",
      "message": "Database/network connection without explicit close",
      "pattern_name": "connection-no-close",
      "severity": "high",
      "snippet": "await prisma.$disconnect();"
    },
    {
      "category": "flow_sensitive",
      "column": 19,
      "file": "backend/src/config/database.ts",
      "line": 62,
      "match_type": "regex",
      "message": "Database/network connection without explicit close",
      "pattern_name": "connection-no-close",
      "severity": "high",
      "snippet": "await prisma.$disconnect();"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/app.ts",
      "line": 79,
      "match_type": "ast",
      "message": "Null origin allowed (regex fallback)",
      "pattern_name": "CORS_NULL_ORIGIN_ALLOWED",
      "severity": "high",
      "snippet": "app.use(cors({"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/app.ts",
      "line": 148,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "app.get('/api/v1/csrf-tok\u200cen', (req: Request, res: Response) => {"
    },
    {
      "category": "business_logic",
      "column": 17,
      "file": "backend/src/app.ts",
      "line": 40,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "timestamp: new Date().toISOString(),"
    },
    {
      "category": "business_logic",
      "column": 17,
      "file": "backend/src/app.ts",
      "line": 49,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "timestamp: new Date().toISOString(),"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/app.ts",
      "line": 156,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.error('CSRF tok\u200cen generation failed:', error);"
    },
    {
      "category": "frameworks/svelte",
      "column": 10,
      "file": "backend/src/app.ts",
      "line": 216,
      "match_type": "regex",
      "message": "Hardcoded credentials in Svelte components",
      "pattern_name": "svelte-hardcoded-credentials",
      "severity": "critical",
      "snippet": "csrfToken: '/api/v1/csrf-tok\u200cen',"
    },
    {
      "category": "frameworks/react",
      "column": 10,
      "file": "backend/src/app.ts",
      "line": 216,
      "match_type": "regex",
      "message": "Hardcoded credentials in React component",
      "pattern_name": "react-hardcoded-credentials",
      "severity": "critical",
      "snippet": "csrfToken: '/api/v1/csrf-tok\u200cen',"
    },
    {
      "category": "frameworks/express",
      "column": 0,
      "file": "backend/src/app.ts",
      "line": 34,
      "match_type": "regex",
      "message": "Express route without error handling",
      "pattern_name": "express-missing-error-handler",
      "severity": "high",
      "snippet": "app.get('/health', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/express",
      "column": 0,
      "file": "backend/src/app.ts",
      "line": 148,
      "match_type": "regex",
      "message": "Express route without error handling",
      "pattern_name": "express-missing-error-handler",
      "severity": "high",
      "snippet": "app.get('/api/v1/csrf-tok\u200cen', (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/express",
      "column": 0,
      "file": "backend/src/app.ts",
      "line": 201,
      "match_type": "regex",
      "message": "Express route without error handling",
      "pattern_name": "express-missing-error-handler",
      "severity": "high",
      "snippet": "app.get('/', (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/angular",
      "column": 10,
      "file": "backend/src/app.ts",
      "line": 216,
      "match_type": "regex",
      "message": "Hardcoded credentials in Angular components or services",
      "pattern_name": "angular-hardcoded-credentials",
      "severity": "critical",
      "snippet": "csrfToken: '/api/v1/csrf-tok\u200cen',"
    },
    {
      "category": "frameworks/svelte",
      "column": 15,
      "file": "backend/src/middleware/auth.ts",
      "line": 76,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "req.user = {"
    },
    {
      "category": "frameworks/svelte",
      "column": 40,
      "file": "backend/src/middleware/auth.ts",
      "line": 102,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "if (!roles.includes(req.user.role)) {"
    },
    {
      "category": "frameworks/svelte",
      "column": 36,
      "file": "backend/src/middleware/auth.ts",
      "line": 123,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "if (req.user.status !== 'ACTIVE') {"
    },
    {
      "category": "frameworks/svelte",
      "column": 35,
      "file": "backend/src/middleware/auth.ts",
      "line": 174,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "if (session && session.user) {"
    },
    {
      "category": "business_logic",
      "column": 12,
      "file": "backend/src/middleware/validation.ts",
      "line": 54,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;"
    },
    {
      "category": "flow_sensitive",
      "column": 2,
      "file": "backend/src/middleware/errorHandler.ts",
      "line": 10,
      "match_type": "regex",
      "message": "Class field used in constructor before initialization",
      "pattern_name": "field-use-before-init",
      "severity": "high",
      "snippet": "constructor(message: string, statusCode: number) {"
    },
    {
      "category": "frameworks/svelte",
      "column": 55,
      "file": "backend/src/middleware/requireAuth.ts",
      "line": 79,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "if (!userRole || !allowedRoles.includes(userRole)) {"
    },
    {
      "category": "frameworks/svelte",
      "column": 47,
      "file": "backend/src/routes/__tests__/admin.routes.test.ts",
      "line": 92,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "describe('GET /api/admin/analytics', () => {"
    },
    {
      "category": "security",
      "column": 70,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 64,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "const res = await request(app).post('/api/auth/register').send({"
    },
    {
      "category": "security",
      "column": 70,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 75,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "const res = await request(app).post('/api/auth/register').send({"
    },
    {
      "category": "security",
      "column": 70,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 86,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "const res = await request(app).post('/api/auth/register').send({"
    },
    {
      "category": "security",
      "column": 67,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 101,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "const res = await request(app).post('/api/auth/login').send({"
    },
    {
      "category": "security",
      "column": 67,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 112,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "const res = await request(app).post('/api/auth/login').send({"
    },
    {
      "category": "runtime_issues",
      "column": 30,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 74,
      "match_type": "regex",
      "message": "Sleep/delay in loop - potential performance issue or race condition",
      "pattern_name": "sleep-in-loop",
      "severity": "medium",
      "snippet": "it('should return 400 for invalid email', async () => {"
    },
    {
      "category": "runtime_issues",
      "column": 30,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 110,
      "match_type": "regex",
      "message": "Sleep/delay in loop - potential performance issue or race condition",
      "pattern_name": "sleep-in-loop",
      "severity": "medium",
      "snippet": "it('should return 401 for invalid cred\u200centials', async () => {"
    },
    {
      "category": "business_logic",
      "column": 80,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 29,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "createSession: jest.fn().mockResolvedValue({ session: { id: '1', expiresAt: new Date() }, accessToken: 'access', refreshToken: 'refresh' }),"
    },
    {
      "category": "business_logic",
      "column": 92,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 32,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "generateEmailVerificationToken: jest.fn().mockReturnValue({ tok\u200cen: 'verify', expiresAt: new Date() }),"
    },
    {
      "category": "business_logic",
      "column": 87,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 33,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "generatePasswordResetToken: jest.fn().mockReturnValue({ tok\u200cen: 'reset', expiresAt: new Date() }),"
    },
    {
      "category": "frameworks/svelte",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 66,
      "match_type": "regex",
      "message": "Hardcoded credentials in Svelte components",
      "pattern_name": "svelte-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/svelte",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 77,
      "match_type": "regex",
      "message": "Hardcoded credentials in Svelte components",
      "pattern_name": "svelte-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/svelte",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 88,
      "match_type": "regex",
      "message": "Hardcoded credentials in Svelte components",
      "pattern_name": "svelte-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/svelte",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 103,
      "match_type": "regex",
      "message": "Hardcoded credentials in Svelte components",
      "pattern_name": "svelte-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/svelte",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 114,
      "match_type": "regex",
      "message": "Hardcoded credentials in Svelte components",
      "pattern_name": "svelte-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/svelte",
      "column": 46,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 59,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "describe('POST /api/auth/register', () => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 59,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 84,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "it('should return 409 if user exists', async () => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 68,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 110,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "it('should return 401 for invalid cred\u200centials', async () => {"
    },
    {
      "category": "frameworks/react",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 66,
      "match_type": "regex",
      "message": "Hardcoded credentials in React component",
      "pattern_name": "react-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/react",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 77,
      "match_type": "regex",
      "message": "Hardcoded credentials in React component",
      "pattern_name": "react-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/react",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 88,
      "match_type": "regex",
      "message": "Hardcoded credentials in React component",
      "pattern_name": "react-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/react",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 103,
      "match_type": "regex",
      "message": "Hardcoded credentials in React component",
      "pattern_name": "react-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/react",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 114,
      "match_type": "regex",
      "message": "Hardcoded credentials in React component",
      "pattern_name": "react-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/angular",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 66,
      "match_type": "regex",
      "message": "Hardcoded credentials in Angular components or services",
      "pattern_name": "angular-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/angular",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 77,
      "match_type": "regex",
      "message": "Hardcoded credentials in Angular components or services",
      "pattern_name": "angular-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/angular",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 88,
      "match_type": "regex",
      "message": "Hardcoded credentials in Angular components or services",
      "pattern_name": "angular-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/angular",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 103,
      "match_type": "regex",
      "message": "Hardcoded credentials in Angular components or services",
      "pattern_name": "angular-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/angular",
      "column": 16,
      "file": "backend/src/routes/__tests__/auth.routes.test.ts",
      "line": 114,
      "match_type": "regex",
      "message": "Hardcoded credentials in Angular components or services",
      "pattern_name": "angular-hardcoded-credentials",
      "severity": "critical",
      "snippet": "pass\u200cword: 'Password1!',"
    },
    {
      "category": "frameworks/svelte",
      "column": 62,
      "file": "backend/src/routes/__tests__/user.routes.test.ts",
      "line": 61,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "it('should return 404 if user not found', async () => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 48,
      "file": "backend/src/routes/__tests__/community.routes.test.ts",
      "line": 64,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "describe('POST /api/community/posts', () => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 51,
      "file": "backend/src/routes/__tests__/community.routes.test.ts",
      "line": 79,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "describe('POST /api/community/comments', () => {"
    },
    {
      "category": "business_logic",
      "column": 41,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 458,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "<p>Generated by Meyden Platform on ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>"
    },
    {
      "category": "db_issues",
      "column": 32,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 327,
      "match_type": "regex",
      "message": "Transaction started but no rollback in error path",
      "pattern_name": "transaction-not-rolled-back",
      "severity": "high",
      "snippet": "if (percentage >= 60) return 'Beginner';"
    },
    {
      "category": "db_issues",
      "column": 153,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 433,
      "match_type": "regex",
      "message": "Transaction started but no rollback in error path",
      "pattern_name": "transaction-not-rolled-back",
      "severity": "high",
      "snippet": "<p class=\"arabic\">\u0645\u0633\u062a\u0648\u0649 \u0627\u0644\u062c\u0627\u0647\u0632\u064a\u0629: ${grade === 'Expert' ? '\u062e\u0628\u064a\u0631' : grade === 'Advanced' ? '\u0645\u062a\u0642\u062f\u0645' : grade === 'Intermediate' ? '\u0645\u062a\u0648\u0633\u0637' : grade === 'Beginner' ? '\u0645\u0628\u062a\u062f\u0626' : '\u0645\u0628\u062a\u062f\u0626'}</p>"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 141,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/surveys', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 185,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/responses', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 63,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 141,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.post('/surveys', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 65,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 185,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.post('/responses', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 45,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 211,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "for (const question of survey.questions) {"
    },
    {
      "category": "frameworks/svelte",
      "column": 56,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 224,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const response = await prisma.surveyResponse.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 31,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 247,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.survey.UPD\u200cATE({"
    },
    {
      "category": "frameworks/svelte",
      "column": 35,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 442,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "<tr><td>Participant</td><td>${response.user ? `${response.user.firstName} ${response.user.lastName}` : 'Anonymous'}</td></tr>"
    },
    {
      "category": "frameworks/svelte",
      "column": 81,
      "file": "backend/src/routes/ai-readiness.routes.ts",
      "line": 442,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "<tr><td>Participant</td><td>${response.user ? `${response.user.firstName} ${response.user.lastName}` : 'Anonymous'}</td></tr>"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 70,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "router.get('/users', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 118,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "router.patch('/users/:id', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 147,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "router.patch('/users/:id/suspend', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 167,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "router.patch('/users/:id/activate', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 295,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "router.get('/settings', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 305,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "router.patch('/settings/:key', async (req: Request, res: Response) => {"
    },
    {
      "category": "business_logic",
      "column": 48,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 212,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "data: { status: 'PUBLISHED', publishedAt: new Date() },"
    },
    {
      "category": "business_logic",
      "column": 44,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 259,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "WH\u200cERE: { createdAt: { gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000) } },"
    },
    {
      "category": "business_logic",
      "column": 44,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 262,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "WH\u200cERE: { createdAt: { gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000) } },"
    },
    {
      "category": "security_compliance",
      "column": 40,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 121,
      "match_type": "regex",
      "message": "Request body data used without validation",
      "pattern_name": "missing-input-validation",
      "severity": "high",
      "snippet": "const data = UPD\u200cATEUserSchema.parse(req.body);"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 31,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.patch('/vendors/:id/approve', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 46,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.patch('/vendors/:id/reject', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 118,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.patch('/users/:id', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 147,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.patch('/users/:id/suspend', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 167,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.patch('/users/:id/activate', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 206,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.patch('/posts/:id/approve', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 223,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.patch('/posts/:id/reject', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 305,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.patch('/settings/:key', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 76,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 31,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.patch('/vendors/:id/approve', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 75,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 46,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.patch('/vendors/:id/reject', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 60,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 70,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.get('/users', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 13,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 160,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "res.json({ message: 'User suspended successfully', user: { id: user.id, status: user.status } });"
    },
    {
      "category": "frameworks/svelte",
      "column": 13,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 177,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "res.json({ message: 'User activated successfully', user: { id: user.id, status: user.status } });"
    },
    {
      "category": "frameworks/svelte",
      "column": 64,
      "file": "backend/src/routes/admin.routes.ts",
      "line": 242,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.get('/analytics', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 15,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 149,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "// Send welcome email"
    },
    {
      "category": "business_logic",
      "column": 28,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 35,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "expiresAt: new Date(Date.now() + 10 * 60 * 1000), // 10 minutes"
    },
    {
      "category": "business_logic",
      "column": 30,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 41,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "if (value.expiresAt < new Date()) {"
    },
    {
      "category": "business_logic",
      "column": 52,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 79,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "if (!storedState || storedState.expiresAt < new Date()) {"
    },
    {
      "category": "business_logic",
      "column": 31,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 175,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "data: { lastLogin: new Date() },"
    },
    {
      "category": "security_compliance",
      "column": 12,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 100,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.error('Google tok\u200cen exchange failed:', error);"
    },
    {
      "category": "security_compliance",
      "column": 12,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 151,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('New user created via Google OAuth', maskPII({ userId: user.id, email }));"
    },
    {
      "category": "security_compliance",
      "column": 8,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 178,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('User logged in via Google OAuth', maskPII({ userId: user.id, email: user.email }));"
    },
    {
      "category": "frameworks/svelte",
      "column": 23,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 74,
      "match_type": "regex",
      "message": "redirect() calls that may use unvalidated user input - creates open redirect vulnerability",
      "pattern_name": "sveltekit-open-redirect",
      "severity": "medium",
      "snippet": "return res.redirect('/login?error=missing_params');"
    },
    {
      "category": "frameworks/svelte",
      "column": 67,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 56,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const authUrl = `ht\u200ctps://accounts.google.com/o/oauth2/v2/auth?${params.toString()}`;"
    },
    {
      "category": "frameworks/svelte",
      "column": 19,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 135,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "if (!user) {"
    },
    {
      "category": "frameworks/svelte",
      "column": 69,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 151,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "logger.info('New user created via Google OAuth', maskPII({ userId: user.id, email }));"
    },
    {
      "category": "frameworks/svelte",
      "column": 35,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 152,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "} else if (!user.googleId) {"
    },
    {
      "category": "frameworks/svelte",
      "column": 74,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 161,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "logger.info('Google account linked to existing user', maskPII({ userId: user.id }));"
    },
    {
      "category": "frameworks/svelte",
      "column": 33,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 173,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.user.UPD\u200cATE({"
    },
    {
      "category": "frameworks/svelte",
      "column": 63,
      "file": "backend/src/routes/oauth.routes.ts",
      "line": 178,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "logger.info('User logged in via Google OAuth', maskPII({ userId: user.id, email: user.email }));"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/community.routes.ts",
      "line": 184,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/posts', requireAuth, async (req: AuthenticatedRequest, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/community.routes.ts",
      "line": 245,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/comments', requireAuth, async (req: AuthenticatedRequest, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/community.routes.ts",
      "line": 340,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/categories/:id/follow', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/community.routes.ts",
      "line": 349,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.DEL\u200cETE('/categories/:id/follow', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/community.routes.ts",
      "line": 359,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/posts/:id/follow', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/community.routes.ts",
      "line": 367,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.DEL\u200cETE('/posts/:id/follow', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 42,
      "file": "backend/src/routes/community.routes.ts",
      "line": 196,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const post = await prisma.post.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 48,
      "file": "backend/src/routes/community.routes.ts",
      "line": 257,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const comment = await prisma.comment.create({"
    },
    {
      "category": "frameworks/svelte",
      "column": 30,
      "file": "backend/src/routes/community.routes.ts",
      "line": 283,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "if (validatedData.postId) {"
    },
    {
      "category": "frameworks/svelte",
      "column": 77,
      "file": "backend/src/routes/community.routes.ts",
      "line": 340,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.post('/categories/:id/follow', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 72,
      "file": "backend/src/routes/community.routes.ts",
      "line": 359,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.post('/posts/:id/follow', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 558,
      "match_type": "ast",
      "message": "Critical endpoint without rate limiting (regex fallback)",
      "pattern_name": "RATE_LIMIT_MISSING_CRITICAL",
      "severity": "critical",
      "snippet": "router.post('/reset-pass\u200cword', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 22,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 74,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "// Helper function to send emails (mock implementation)"
    },
    {
      "category": "security",
      "column": 7,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 157,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "// Send verification email if enabled"
    },
    {
      "category": "security",
      "column": 12,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 160,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "await sendEmail("
    },
    {
      "category": "security",
      "column": 7,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 528,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "// Send reset email"
    },
    {
      "category": "business_logic",
      "column": 28,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 413,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "expiresAt: new Date(Date.now() + 15 * 60 * 1000), // 15 minutes"
    },
    {
      "category": "security_compliance",
      "column": 2,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 77,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info(`Email would be sent to ${maskPII({ email: to })}: ${subject}`);"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 167,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('User registered successfully', maskPII({ userId: user.id, email: user.email }));"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 297,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('User logged in successfully', maskPII({ userId: user.id, email: user.email }));"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 427,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.error('Token refresh error:', maskPII(error));"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 467,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('Email verified successfully', maskPII({ userId: user.id }));"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 482,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.error('Email verification error:', maskPII(error));"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 536,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('Password reset email sent', maskPII({ userId: user.id }));"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 549,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.error('Forgot pass\u200cword error:', maskPII(error));"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 605,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('Password reset successfully', maskPII({ userId: user.id }));"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 620,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.error('Reset pass\u200cword error:', maskPII(error));"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 81,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/register', registerLimiter, async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 195,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/login', loginLimiter, async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 331,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/logout', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 364,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/refresh', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 436,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/verify-email', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 491,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/forgot-pass\u200cword', async (req: Request, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 558,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/reset-pass\u200cword', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 56,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 167,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "logger.info('User registered successfully', maskPII({ userId: user.id, email: user.email }));"
    },
    {
      "category": "frameworks/svelte",
      "column": 25,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 169,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "res.status(201).json({"
    },
    {
      "category": "frameworks/svelte",
      "column": 29,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 271,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.user.UPD\u200cATE({"
    },
    {
      "category": "frameworks/svelte",
      "column": 21,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 285,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "const userData = {"
    },
    {
      "category": "frameworks/svelte",
      "column": 55,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 297,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "logger.info('User logged in successfully', maskPII({ userId: user.id, email: user.email }));"
    },
    {
      "category": "frameworks/svelte",
      "column": 29,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 458,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.user.UPD\u200cATE({"
    },
    {
      "category": "frameworks/svelte",
      "column": 55,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 467,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "logger.info('Email verified successfully', maskPII({ userId: user.id }));"
    },
    {
      "category": "frameworks/svelte",
      "column": 29,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 520,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.user.UPD\u200cATE({"
    },
    {
      "category": "frameworks/svelte",
      "column": 53,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 536,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "logger.info('Password reset email sent', maskPII({ userId: user.id }));"
    },
    {
      "category": "frameworks/svelte",
      "column": 29,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 593,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "await prisma.user.UPD\u200cATE({"
    },
    {
      "category": "frameworks/svelte",
      "column": 55,
      "file": "backend/src/routes/auth.routes.ts",
      "line": 605,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "logger.info('Password reset successfully', maskPII({ userId: user.id }));"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/upload.routes.ts",
      "line": 7,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/upload', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/user.routes.ts",
      "line": 41,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "router.get('/profile', requireAuth, async (req: AuthenticatedRequest, res: Response) => {"
    },
    {
      "category": "security",
      "column": 0,
      "file": "backend/src/routes/user.routes.ts",
      "line": 93,
      "match_type": "regex",
      "message": "Route/endpoint without authentication decorator or middleware",
      "pattern_name": "missing-authentication-decorator",
      "severity": "high",
      "snippet": "router.put('/profile', requireAuth, async (req: AuthenticatedRequest, res: Response) => {"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/user.routes.ts",
      "line": 93,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.put('/profile', requireAuth, async (req: AuthenticatedRequest, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 13,
      "file": "backend/src/routes/user.routes.ts",
      "line": 67,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "res.json({"
    },
    {
      "category": "frameworks/svelte",
      "column": 12,
      "file": "backend/src/routes/user.routes.ts",
      "line": 117,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "data: {"
    },
    {
      "category": "business_logic",
      "column": 16,
      "file": "backend/src/server.ts",
      "line": 26,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "\u23f0 Started at: ${new Date().toISOString()}"
    },
    {
      "category": "security_compliance",
      "column": 51,
      "file": "backend/src/routes/vendor.routes.ts",
      "line": 174,
      "match_type": "regex",
      "message": "Request body data used without validation",
      "pattern_name": "missing-input-validation",
      "severity": "high",
      "snippet": "const validatedData = createVendorSchema.parse(req.body);"
    },
    {
      "category": "security_compliance",
      "column": 0,
      "file": "backend/src/routes/vendor.routes.ts",
      "line": 172,
      "match_type": "regex",
      "message": "State-changing route without CSRF protection",
      "pattern_name": "missing-csrf-protection",
      "severity": "high",
      "snippet": "router.post('/', requireAuth, async (req: AuthenticatedRequest, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 55,
      "file": "backend/src/routes/vendor.routes.ts",
      "line": 33,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.get('/', async (req: Request, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 82,
      "file": "backend/src/routes/vendor.routes.ts",
      "line": 172,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.post('/', requireAuth, async (req: AuthenticatedRequest, res: Response) => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 67,
      "file": "backend/src/routes/vendor.routes.ts",
      "line": 274,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "router.get('/popular/list', async (req: Request, res: Response) => {"
    },
    {
      "category": "security",
      "column": 25,
      "file": "backend/src/services/email.service.ts",
      "line": 12,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "* Email Service using Resend (free tier: 100 emails/day)"
    },
    {
      "category": "security",
      "column": 31,
      "file": "backend/src/services/email.service.ts",
      "line": 22,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "this.apiKey = config.resendApiKey;"
    },
    {
      "category": "security",
      "column": 61,
      "file": "backend/src/services/email.service.ts",
      "line": 28,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "logger.warn('Email service not configured. Set RESEND_API_KEY in environment.');"
    },
    {
      "category": "security",
      "column": 56,
      "file": "backend/src/services/email.service.ts",
      "line": 39,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "const response = await fetch('ht\u200ctps://api.resend.com/emails', {"
    },
    {
      "category": "security",
      "column": 40,
      "file": "backend/src/services/email.service.ts",
      "line": 56,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "logger.error('Failed to send email:', error);"
    },
    {
      "category": "security",
      "column": 32,
      "file": "backend/src/services/email.service.ts",
      "line": 64,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "logger.error('Email sending error:', error);"
    },
    {
      "category": "security",
      "column": 10,
      "file": "backend/src/services/email.service.ts",
      "line": 105,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "async sendPasswordResetEmail(to: string, tok\u200cen: string, baseUrl: string): Promise<boolean> {"
    },
    {
      "category": "security",
      "column": 20,
      "file": "backend/src/services/email.service.ts",
      "line": 108,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "return this.send({"
    },
    {
      "category": "security",
      "column": 10,
      "file": "backend/src/services/email.service.ts",
      "line": 138,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "async sendVendorContactEmail("
    },
    {
      "category": "security",
      "column": 20,
      "file": "backend/src/services/email.service.ts",
      "line": 145,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "return this.send({"
    },
    {
      "category": "security",
      "column": 70,
      "file": "backend/src/services/email.service.ts",
      "line": 160,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "<p style=\"margin: 0 0 10px 0;\"><strong>FR\u200cOM:</strong> ${senderName}</p>"
    },
    {
      "category": "security",
      "column": 56,
      "file": "backend/src/services/email.service.ts",
      "line": 166,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "Reply directly to this email or contact ${senderEmail}"
    },
    {
      "category": "runtime_issues",
      "column": 4,
      "file": "backend/src/services/email.service.ts",
      "line": 32,
      "match_type": "regex",
      "message": "Async function call without await - potential race condition",
      "pattern_name": "async-without-await",
      "severity": "high",
      "snippet": "async send(options: EmailOptions): Promise<boolean> {"
    },
    {
      "category": "runtime_issues",
      "column": 4,
      "file": "backend/src/services/email.service.ts",
      "line": 71,
      "match_type": "regex",
      "message": "Async function call without await - potential race condition",
      "pattern_name": "async-without-await",
      "severity": "high",
      "snippet": "async sendVerificationEmail(to: string, tok\u200cen: string, baseUrl: string): Promise<boolean> {"
    },
    {
      "category": "runtime_issues",
      "column": 4,
      "file": "backend/src/services/email.service.ts",
      "line": 105,
      "match_type": "regex",
      "message": "Async function call without await - potential race condition",
      "pattern_name": "async-without-await",
      "severity": "high",
      "snippet": "async sendPasswordResetEmail(to: string, tok\u200cen: string, baseUrl: string): Promise<boolean> {"
    },
    {
      "category": "runtime_issues",
      "column": 4,
      "file": "backend/src/services/email.service.ts",
      "line": 174,
      "match_type": "regex",
      "message": "Async function call without await - potential race condition",
      "pattern_name": "async-without-await",
      "severity": "high",
      "snippet": "async sendWelcomeEmail(to: string, firstName: string): Promise<boolean> {"
    },
    {
      "category": "security_compliance",
      "column": 12,
      "file": "backend/src/services/email.service.ts",
      "line": 28,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.warn('Email service not configured. Set RESEND_API_KEY in environment.');"
    },
    {
      "category": "security_compliance",
      "column": 12,
      "file": "backend/src/services/email.service.ts",
      "line": 34,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('Email would be sent (service not configured):', { to: options.to, subject: options.subject });"
    },
    {
      "category": "security_compliance",
      "column": 16,
      "file": "backend/src/services/email.service.ts",
      "line": 56,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.error('Failed to send email:', error);"
    },
    {
      "category": "security_compliance",
      "column": 12,
      "file": "backend/src/services/email.service.ts",
      "line": 61,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.info('Email sent successfully:', { id: result.id, to: options.to });"
    },
    {
      "category": "security_compliance",
      "column": 12,
      "file": "backend/src/services/email.service.ts",
      "line": 64,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.error('Email sending error:', error);"
    },
    {
      "category": "security_compliance",
      "column": 41,
      "file": "backend/src/services/email.service.ts",
      "line": 39,
      "match_type": "regex",
      "message": "Hardcoded production API endpoint (should use environment variables)",
      "pattern_name": "hardcoded-api-endpoint",
      "severity": "medium",
      "snippet": "const response = await fetch('ht\u200ctps://api.resend.com/emails', {"
    },
    {
      "category": "security",
      "column": 29,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 64,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "describe('sanitizeUserForBroadcast', () => {"
    },
    {
      "category": "security",
      "column": 45,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 78,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "const sanitized = sanitizeUserForBroadcast(user);"
    },
    {
      "category": "business_logic",
      "column": 30,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 74,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "lockoutUntil: new Date(),"
    },
    {
      "category": "frameworks/svelte",
      "column": 28,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 39,
      "match_type": "regex",
      "message": "Hardcoded credentials in Svelte components",
      "pattern_name": "svelte-hardcoded-credentials",
      "severity": "critical",
      "snippet": "const input = { pass\u200cword: 'sec\u200cret123' };"
    },
    {
      "category": "frameworks/svelte",
      "column": 45,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 40,
      "match_type": "regex",
      "message": "Hardcoded credentials in Svelte components",
      "pattern_name": "svelte-hardcoded-credentials",
      "severity": "critical",
      "snippet": "expect(maskPII(input)).toEqual({ pass\u200cword: '***MASKED***' });"
    },
    {
      "category": "frameworks/react",
      "column": 28,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 39,
      "match_type": "regex",
      "message": "Hardcoded credentials in React component",
      "pattern_name": "react-hardcoded-credentials",
      "severity": "critical",
      "snippet": "const input = { pass\u200cword: 'sec\u200cret123' };"
    },
    {
      "category": "frameworks/react",
      "column": 45,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 40,
      "match_type": "regex",
      "message": "Hardcoded credentials in React component",
      "pattern_name": "react-hardcoded-credentials",
      "severity": "critical",
      "snippet": "expect(maskPII(input)).toEqual({ pass\u200cword: '***MASKED***' });"
    },
    {
      "category": "frameworks/angular",
      "column": 28,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 39,
      "match_type": "regex",
      "message": "Hardcoded credentials in Angular components or services",
      "pattern_name": "angular-hardcoded-credentials",
      "severity": "critical",
      "snippet": "const input = { pass\u200cword: 'sec\u200cret123' };"
    },
    {
      "category": "frameworks/angular",
      "column": 45,
      "file": "backend/src/utils/__tests__/sanitize.test.ts",
      "line": 40,
      "match_type": "regex",
      "message": "Hardcoded credentials in Angular components or services",
      "pattern_name": "angular-hardcoded-credentials",
      "severity": "critical",
      "snippet": "expect(maskPII(input)).toEqual({ pass\u200cword: '***MASKED***' });"
    },
    {
      "category": "business_logic",
      "column": 29,
      "file": "backend/src/utils/auth.ts",
      "line": 65,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 hours"
    },
    {
      "category": "business_logic",
      "column": 29,
      "file": "backend/src/utils/auth.ts",
      "line": 73,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "const expiresAt = new Date(Date.now() + 60 * 60 * 1000); // 1 hour"
    },
    {
      "category": "business_logic",
      "column": 26,
      "file": "backend/src/utils/auth.ts",
      "line": 90,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "expiresAt: new Date(Date.now() + 15 * 60 * 1000), // 15 minutes"
    },
    {
      "category": "business_logic",
      "column": 29,
      "file": "backend/src/utils/auth.ts",
      "line": 120,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "const expiresAt = new Date(Date.now() + 10 * 60 * 1000); // 10 minutes"
    },
    {
      "category": "security_compliance",
      "column": 4,
      "file": "backend/src/utils/auth.ts",
      "line": 47,
      "match_type": "regex",
      "message": "Logging of Personally Identifiable Information without masking",
      "pattern_name": "pii-logging-leak",
      "severity": "high",
      "snippet": "logger.warn('Token verification failed:', maskPII(error));"
    },
    {
      "category": "security_compliance",
      "column": 16,
      "file": "backend/src/utils/auth.ts",
      "line": 14,
      "match_type": "regex",
      "message": "JWT created with weak algorithm or missing expiration",
      "pattern_name": "insecure-jwt-creation",
      "severity": "critical",
      "snippet": "const tok\u200cen = jwt.sign("
    },
    {
      "category": "security_compliance",
      "column": 23,
      "file": "backend/src/utils/auth.ts",
      "line": 25,
      "match_type": "regex",
      "message": "JWT created with weak algorithm or missing expiration",
      "pattern_name": "insecure-jwt-creation",
      "severity": "critical",
      "snippet": "const refreshToken = jwt.sign("
    },
    {
      "category": "frameworks/svelte",
      "column": 132,
      "file": "backend/src/utils/auth.ts",
      "line": 129,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "export const rateLimitLoginAttempts = async (email: string, ipAddress: string): Promise<{ allowed: boolean; remaining: number }> => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 9,
      "file": "backend/src/utils/auth.ts",
      "line": 139,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "return {"
    },
    {
      "category": "frameworks/svelte",
      "column": 109,
      "file": "backend/src/utils/auth.ts",
      "line": 149,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "export const checkAccountLockout = async (email: string): Promise<{ locked: boolean; remaining: number }> => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 78,
      "file": "backend/src/utils/auth.ts",
      "line": 167,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "export const incrementLoginAttempts = async (email: string): Promise<void> => {"
    },
    {
      "category": "frameworks/svelte",
      "column": 74,
      "file": "backend/src/utils/auth.ts",
      "line": 184,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "export const resetLoginAttempts = async (email: string): Promise<void> => {"
    },
    {
      "category": "business_logic",
      "column": 18,
      "file": "backend/src/utils/datetime.ts",
      "line": 5,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "return new Date(Date.now());"
    },
    {
      "category": "business_logic",
      "column": 18,
      "file": "backend/src/utils/datetime.ts",
      "line": 22,
      "match_type": "regex",
      "message": "Using naive datetime without timezone awareness",
      "pattern_name": "timezone-naive-datetime",
      "severity": "medium",
      "snippet": "return new Date(Date.now() + offsetMs);"
    },
    {
      "category": "frameworks/svelte",
      "column": 90,
      "file": "backend/src/utils/pagination.ts",
      "line": 15,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "export const getPaginationParams = (req: Request, defaultLimit = 20): PaginationParams => {"
    },
    {
      "category": "security",
      "column": 36,
      "file": "backend/src/utils/sanitize.ts",
      "line": 88,
      "match_type": "regex",
      "message": "WebSocket broadcasting potentially sensitive data",
      "pattern_name": "websocket-broadcast-sensitive-data",
      "severity": "critical",
      "snippet": "* Sanitize user data for WebSocket broadcasting"
    },
    {
      "category": "frameworks/svelte",
      "column": 28,
      "file": "backend/src/utils/sanitize.ts",
      "line": 14,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "if (Array.isArray(input)) {"
    },
    {
      "category": "frameworks/svelte",
      "column": 27,
      "file": "backend/src/utils/sanitize.ts",
      "line": 49,
      "match_type": "regex",
      "message": "User input rendered without escaping - potential XSS",
      "pattern_name": "svelte-unescaped-user-input",
      "severity": "medium",
      "snippet": "if (Array.isArray(data)) {"
    }
  ]
}